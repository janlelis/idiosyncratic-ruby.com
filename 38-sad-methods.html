<!doctype html>
<html>
  <head>
    <title>Idiosyncratic Ruby - Sad Methods</title>
    <link rel="alternate" type="application/atom+xml" title="Idiosyncratic Ruby Feed" href="/feed.xml" />
<link href="/stylesheets/all.css" rel="stylesheet" type="text/css" />
<link href='http://fonts.googleapis.com/css?family=Lato:300' rel='stylesheet' type='text/css'>
<link rel="alternate" type="application/atom+xml" title="Idiosyncratic Ruby" href="https://feeds.feedburner.com/IdiosyncraticRuby" />

<script src="/javascripts/jquery.min.js" type="text/javascript"></script><script src="/javascripts/app.js" type="text/javascript"></script>

<meta charset="utf-8">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<meta name="description" content="Documentaing all Ruby Specialities. A New Post Every Day in May 2016!"/>
<meta name="keywords" content="ruby, core, cruby, reflection, metaprogramming"/>

  </head>

  <body>
    <div class="world">
      <section class="post-header">
        <a href="/" class="post-logo"><img src="/images/idiosyncratic.png" alt="Idiosyncratic Ruby"></a>
        <h1 class="post-heading" id="top"><a href="/38-sad-methods.html">Sad Methods</a></h1>
      </section>

      <article class="post">
        <p>In general, Ruby's <a href="https://en.wikipedia.org/wiki/Reflection_%28computer_programming%29">reflection capabilities</a> are pretty powerful, although <a href="http://idiosyncratic-ruby.com/25-meta-methodology.html">not always logical</a>. However, when reflecting on a method's (or proc's) usage, you are sometimes stuck with <strong>sad methods</strong>.</p>

<p></p>

<p>Sad methods only work for code, that is written in Ruby itself. And Ruby itself (official MRI) is written in C, which limits such methods' usefulness quite a lot. This is an implementation specific problem, and it naturally does not occur in implementations like <a href="http://rubinius.com/">Rubinius</a>. The following three methods are affected:</p>

<h2 id="arity">Arity</h2>

<p>The arity of a method (or proc) will return:</p>

<ul>
  <li>A positive number if the method has a fixed number of arguments</li>
  <li>A negative number if the method has a variable number of arguments, the value denoting the number of required arguments</li>
</ul>

<p>For example:</p>

<pre><code>method(:require).arity # =&gt; 1
</code></pre>

<p>However: <a href="http://ruby-doc.org/core-2.3.1/Method.html#method-i-arity">For methods written in C, returns -1 if the call takes a variable number of arguments</a></p>

<pre><code>method(:puts).arity # =&gt; -1
</code></pre>

<h2 id="source-location">Source Location</h2>

<p>The <code>source_location</code> of a method (or proc) returns a two-element array containing the path to the source file and the line number, where it is defined:</p>

<pre><code>method(:require).source_location
# =&gt; ["/home/jan/.rvm/rubies/ruby-2.3.0/lib/.../core_ext/kernel_require.rb", 39]
</code></pre>

<p>However: <a href="http://ruby-doc.org/core-2.3.1/Method.html#method-i-source_location">Returns [â€¦] nil if this method was not defined in Ruby (i.e. native)</a></p>

<pre><code>method(:puts).source_location # =&gt; nil
</code></pre>

<h2 id="parameters">Parameters</h2>

<p>The <code>Method#parameters</code> method lets inspect what kind of parameters a method (or proc) takes:</p>

<pre><code>FileUtils.method(:cd).parameters
# =&gt; [[:req, :dir], [:opt, :options], [:block, :block]]
</code></pre>

<p>However: Like <code>arity</code>, it will treat all C methods with multiple arguments as "variable number of arguments", instead of providing exact information:</p>

<pre><code>Module.instance_method(:define_method).parameters
#=&gt; [[:rest]]
</code></pre>

<h2 id="also-see">Also See</h2>

<ul>
  <li><a href="https://github.com/banister/method_source">method_source: Retrieve the method source via source_location</a></li>
  <li><a href="https://github.com/janlelis/debugging#howtocallobj--self-method_or_proc">howtocall: Extended version of <code>Method#parameters</code></a></li>
</ul>


        <h2>More Idiosyncratic Ruby</h2>
        <ul>
          <li><a href="https://github.com/janlelis/idiosyncratic-ruby.com/commit/dcad9080db57bce96f53019244d609e554c81975#all_commit_comments">Please Comment on GitHub</a></li>
          <li><a class="twitter-share-button" href="https://twitter.com/share"
            data-via="idiosyncraticrb"
            data-count="horizontal"
            data-dnt="true"
          > Tweet this Episode
        </a><script>window.twttr=(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return;js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);t._e=[];t.ready=function(f){t._e.push(f);};return t;}(document,"script","twitter-wjs"));</script></li>
            <li>Next Article: <a href="/39-fixed-numbers.html">Fixed Numbers</a></li>
            <li>Previous Article: <a href="/37-static-monkeys-vs-strong-ducks.html">Static Monkeys vs. Strong Ducks</a></li>
        </ul>
      </article>

      <footer>
        <div class="footer-right">
          On <a href="/">Idiosyncratic Ruby</a> by <a href="https://github.com/janlelis">Jan Lelis</a><br>
          
        </div>
        About Core, Cruby, Reflection, Metaprogramming |
        Last Update: 2016-05-14
      </footer>
    </div>
    <script src="/javascripts/rainbow-custom.min.js" type="text/javascript"></script>
  </body>
</html>